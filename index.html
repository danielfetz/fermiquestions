<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="theme-color" content="#f4f8fa">
    <title>Fermi Questions</title>
    <meta name="description" content="A Wordle-style game for Fermi questions.">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <script defer data-domain="fermiquestions.org" src="https://plausible.io/js/script.hash.js"></script>
    <!-- Supabase client library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
        <header class="game-header">
            <div class="header-left">
                <img src="https://upload.wikimedia.org/wikipedia/commons/6/6f/Photograph_of_Enrico_Fermi_-_NARA_-_595043.gif" alt="Enrico Fermi" class="fermi-logo">
                <h1 class="game-title">
                    <span>Fermi Questions</span>
                </h1>
            </div>
            <div class="header-right">
                <button class="icon-button" id="help-btn">?</button>
                <button class="icon-button" id="stats-btn">
                    <svg width="20" height="18" viewBox="0 0 58 51" fill="none" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges">
                        <rect x="2" y="28" width="8" height="21" fill="#333333"/>
                        <rect x="19" y="15" width="10" height="34" fill="#333333"/>
                        <rect x="38" y="2" width="12" height="47" fill="#333333"/>
                    </svg>
                </button>
            </div>
        </header>
    <div class="game-container">
        <!-- Question Display -->
        <div class="question-container">
            <div class="question-box">
                <div class="question-content">
                    <div class="question-image-container" id="question-image-container">
                        <img class="question-image" id="question-image" alt="" />
                    </div>
                    <div class="question-text-container">
                        <div class="question-text" id="question-text">
                            How many chickens are slaughtered each year?
                        </div>
                        <div class="question-category" id="question-category">
                            Agriculture
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Questions History Modal -->
        <div class="modal" id="questions-modal">
            <div class="modal-content">
                <h2>Question History</h2>
                <div class="questions-list" id="questions-list">
                    <!-- Questions will be populated here -->
                </div>
                <button id="close-questions-btn" class="close-btn">Close</button>
            </div>
        </div>

        <!-- Guess Counter -->
        <div class="guess-counter" id="guess-counter">
            <span id="current-streak-display">Current streak: 0</span>
            <button id="strategy-tips-btn" class="strategy-link" aria-controls="help-modal" aria-haspopup="dialog">How to Play <span class="arrow">></span></button>
        </div>

        <!-- Hint (hidden by default) -->
        <div class="hint-container" id="hint-container" style="display: none;">
            <div class="hint-text" id="hint-text"></div>
            <button id="hint-modal-btn" class="hint-link" aria-controls="hint-modal" aria-haspopup="dialog">Show hint <span class="arrow">></span></button>
        </div>

        <!-- Game Result (hidden by default) -->
        <div class="game-result" id="game-result" style="display: none;">
            <div class="result-container" id="result-container">
                <span class="result-emoji" id="result-emoji" aria-hidden="true"></span>
                <div class="result-text" id="result-text">
                    <span class="result-message" id="result-message"></span>
                    <span class="correct-answer" id="correct-answer"></span>
                </div>
            </div>
        </div>

        <!-- Previous Guesses -->
        <div class="guesses-container" id="guesses-container">
            <!-- Guesses will be populated here -->
        </div>

        <!-- Input Section -->
        <div class="input-section" id="input-section">
            <div class="input-row">
                <div class="input-container">
                    <input 
                        type="text" 
                        id="guess-input" 
                        placeholder="Enter a guess..." 
                        inputmode="numeric"
                        pattern="[0-9,]*"
                    >
                </div>
                <button id="submit-btn" class="submit-btn">Submit</button>
            </div>
        </div>

        <!-- New Game Button (hidden by default) -->
        <div class="new-game-section" id="new-game-section" style="display: none;">
            <button id="share-btn" class="share-btn" style="display: none;">Share</button>
            <button id="new-game-btn-inline" class="new-game-btn-inline">Play more</button>
        </div>

        <!-- Game Over Modal -->
        <div class="modal" id="game-over-modal">
            <div class="modal-content">
                <h2 id="modal-title">Game Over!</h2>
                <p id="modal-message"></p>
                <p id="modal-answer"></p>
                <button id="new-game-btn" class="new-game-btn">New Game</button>
            </div>
        </div>

        <!-- Help Modal -->
        <div class="modal" id="help-modal">
            <div class="modal-content">
                <h2>How to Play</h2>
                <p>Guess the answer to estimation questions in 6 or less tries.</p>
                <p>After each guess, you'll see if your answer was too high or too low. An arrow pointing down means that the correct answer is below your guess.</p>
                <p>The color of the arrows shows how close you are: orange indicates your guess is within ±50% of the answer, red means it is further away</p>
                <p>You win if your guess is within ±20% of the correct answer.</p>
                <button id="close-help-btn" class="close-btn">Close</button>
            </div>
        </div>

        <!-- Strategy Tips Modal -->
        <div class="modal" id="strategy-modal">
            <div class="modal-content">
                <h2>Strategy tips</h2>
                <p>Make a Fermi estimate: break the problem into simple factors, choose round numbers, then multiply.</p>
                <p>Example: How many pizzas are eaten in NYC per day?</p>
                <p>Population ≈ 8M. About half eat pizza weekly → 4M people. Typical serving ≈ 2 slices per person per week → 8M slices/week. Per day ≈ 8M/7 ≈ 1.1M slices/day. ≈ 8 slices/pizza → ~140k pizzas/day.</p>
                <button id="close-strategy-btn" class="close-btn">Close</button>
            </div>
        </div>

        <!-- Hint Modal -->
        <div class="modal" id="hint-modal">
            <div class="modal-content">
                <h2>Hint</h2>
                <p id="hint-modal-text"></p>
                <button id="close-hint-btn" class="close-btn">Close</button>
            </div>
        </div>

        <!-- Stats Modal -->
        <div class="modal" id="stats-modal">
            <div class="modal-content">
                <h2>Statistics</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-number" id="games-played">0</span>
                        <span class="stat-label">Games Played</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="games-won">0</span>
                        <span class="stat-label">Games Won</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="win-rate">0%</span>
                        <span class="stat-label">Win Rate</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="current-streak">0</span>
                        <span class="stat-label">Current Streak</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="max-streak">0</span>
                        <span class="stat-label">Max Streak</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="guess-average">0</span>
                        <span class="stat-label">Guess Average</span>
                    </div>
                </div>
                
                <div class="guess-distribution">
                    <h3>Guess Distribution</h3>
                    <div class="distribution-bars">
                        <div class="dist-row">
                            <span class="dist-label">1</span>
                            <div class="dist-bar-container">
                                <div class="dist-bar" id="dist-1" style="width: 0%"></div>
                            </div>
                            <span class="dist-count" id="count-1">0</span>
                        </div>
                        <div class="dist-row">
                            <span class="dist-label">2</span>
                            <div class="dist-bar-container">
                                <div class="dist-bar" id="dist-2" style="width: 0%"></div>
                            </div>
                            <span class="dist-count" id="count-2">0</span>
                        </div>
                        <div class="dist-row">
                            <span class="dist-label">3</span>
                            <div class="dist-bar-container">
                                <div class="dist-bar" id="dist-3" style="width: 0%"></div>
                            </div>
                            <span class="dist-count" id="count-3">0</span>
                        </div>
                        <div class="dist-row">
                            <span class="dist-label">4</span>
                            <div class="dist-bar-container">
                                <div class="dist-bar" id="dist-4" style="width: 0%"></div>
                            </div>
                            <span class="dist-count" id="count-4">0</span>
                        </div>
                        <div class="dist-row">
                            <span class="dist-label">5</span>
                            <div class="dist-bar-container">
                                <div class="dist-bar" id="dist-5" style="width: 0%"></div>
                            </div>
                            <span class="dist-count" id="count-5">0</span>
                        </div>
                        <div class="dist-row">
                            <span class="dist-label">6</span>
                            <div class="dist-bar-container">
                                <div class="dist-bar" id="dist-6" style="width: 0%"></div>
                            </div>
                            <span class="dist-count" id="count-6">0</span>
                        </div>
                    </div>
                </div>

                <button id="share-stats-btn" class="share-btn">Share</button>
                <button id="close-stats-btn" class="close-btn">Close</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html> 
